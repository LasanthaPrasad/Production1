{% extends "base.html" %}

{% block content %}
<h1>Solar Plants</h1>
<a href="{{ url_for('create_solar_plant') }}" class="btn btn-primary mb-3">Create New Solar Plant</a>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>Grid Substation</th>
            <th>Feeder</th>
            <th>Installed Capacity (MW)</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for plant in plants %}
        <tr>
            <td>{{ plant.id }}</td>
            <td>{{ plant.name }}</td>
            <td>{{ plant.latitude }}</td>
            <td>{{ plant.longitude }}</td>
            <td>{{ plant.grid_substation.name if plant.grid_substation else 'N/A' }}</td>
            <td>{{ plant.feeder.name if plant.feeder else 'N/A' }}</td>
            <td>{{ plant.installed_capacity }}</td>
            <td>
                <a href="{{ url_for('edit_solar_plant', id=plant.id) }}" class="btn btn-sm btn-warning">Edit</a>
                <form action="{{ url_for('delete_solar_plant', id=plant.id) }}" method="POST" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

{% block extra_js %}
<script>
function initMap() {
    const map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 7.8731, lng: 80.7718 },  // Center of Sri Lanka
        zoom: 8,
    });

  //  {% for plant in plants %}
  //  new google.maps.Marker({
  //      position: { lat: {{ plant.latitude }}, lng: {{ plant.longitude }} },
  //      map: map,
 //       title: "{{ plant.name }}"
 //   });
 //   {% endfor %}
}

document.addEventListener("DOMContentLoaded", initMap);
</script>
{% endblock %}